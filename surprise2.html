<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Surprise 2 â€” A Letter</title>
  <link rel="stylesheet" href="surprise.css">
  <link rel="stylesheet" href="letter.css">
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
</head>
<body>
  <div class="background"></div>
  <div class="container">
    <main class="letter-wrap">
      <div class="paper" id="paper">
        <div class="paper-label">Liham</div>
        <div class="paper-inner" id="paperInner">
          <h2>My Dearest,</h2>
          <p class="magical-text">
            Marahil ay hindi mo inaasahan na ako ay magbibigay ulit ng ganitong uri ng liham, aking minamahal na binibini. May katagalan narin pala nung una akong nagbigay ako ng liham gamit ang teknolohiya kung kaya't sana ay magustuhan mo parin itong inahanda ko para sa iyo. Tama, nawa'y tama ang aking pagkakaalala na aking nabanggit na hindi lamang para sa magkasintahan ang araw na ito, ang araw ng mga puso. Pero aaminin ko sa'yong mas nakakapanabik pala talagang ipagdiriwang itong araw na ito kasama ang espesyal na tao sa aking buhay, sa madaling salita ay kasama ka. Noon pa man ay sobrang gaan na ng aking loob sa pagsusulat ng ganitong liham, at kahit pa may katagalan narin nung huli ko itong ginawa, ay tila ba hindi ako mauubusan ng salitang gustong sabihin sa iyo. Ganon pa man, wala akong ibang ninanais kundi maramdaman mo ang diwa ng araw na ito, hindi lamang sa okasyon na ito kundi pati na rin sa pang araw-araw na pamumuhay. Nawa'y maramdaman mo rin ang pagmamahal na kaya mong iparamdam at ibigay sa mga taong mahahalaga sa iyong buhay. At bukod sa lahat, ang tanging bagay na gusto kong ipaalala sa iyo ay ang pagmamahal at pagtitiwala sa iyong sarili. Mahalaga ka akin Freya, sana ay naipaparamdam ko parin ang bagay na ito sayo. Mahal na mahal kita.
          </p>
          <div class="signature-block">
            <p class="signature">
              Nagmamahal,
              <span class="signature-name">Christian</span>
            </p>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script>
    // When page loads, play crumpled -> unfold animation
    document.addEventListener('DOMContentLoaded', function () {
      const paper = document.getElementById('paper');
      const inner = document.getElementById('paperInner');
      if (!paper || !inner) return;

      // start crumpled animation (already applied by default)
      // after 5 seconds, remove crumple and reveal inner text
      setTimeout(() => {
        paper.classList.add('uncrumple');
      }, 5000);

      // Reveal inner content slightly after and start magical animation
      paper.addEventListener('transitionend', function (e) {
        if (e.propertyName.includes('transform')) {
          inner.classList.add('reveal');
          if (typeof window.animateMagicalText === 'function') window.animateMagicalText();
        }
      });
    });
  </script>
  <script>
    // Magical word-by-word animation (split into words, animate sequentially)
    // Exposed as window.animateMagicalText and only runs when called (after paper reveals)
    (function () {
      const delayPerWord = 140; // ms between word casts

      function animateParagraph(par) {
        const raw = par.textContent.trim();
        const words = raw.split(/\s+/);
        par.textContent = ''; // clear

        words.forEach((word, i) => {
          const span = document.createElement('span');
          span.className = 'magical-word';
          span.textContent = word;
          par.appendChild(span);
          if (i !== words.length - 1) par.appendChild(document.createTextNode(' '));

          const baseDelay = i * delayPerWord;

          // start fiery glow
          setTimeout(() => { span.classList.add('fiery'); }, baseDelay);

          // shimmer trace shortly after
          setTimeout(() => { span.classList.add('shimmer'); }, baseDelay + 300);

          // settle into magical final state
          setTimeout(() => {
            span.classList.remove('fiery', 'shimmer');
            span.classList.add('magical-final');
          }, baseDelay + 900);
        });
      }

      window.animateMagicalText = function () {
        document.querySelectorAll('.magical-text').forEach(par => {
          // only animate if not already processed
          if (par.dataset.animated) return;
          par.dataset.animated = '1';
          animateParagraph(par);
        });
      };
    })();
  </script>
</body>
</html>
